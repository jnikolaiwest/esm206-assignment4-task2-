---
title: "Assignment 4 - Task 2"
author: "Jessica West"
date: "11/4/2021"
output: html_document
---

```{r setup, include= FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

library(tidyverse)
library(janitor)
library(here)
library(lubridate)
library(broom)
library(kableExtra)
library(equatiomatic)
```

```{r}
bonanza_hares_juv_genders <- read_csv(here("data", "bonanza_hares.csv")) %>% 
    mutate(sex = case_when(sex == "m" ~ "Male", 
                         sex == "f" ~ "Female")) %>% 
    filter(age == "j")
```

## Introduction

a)	Introduction: A 4 - 5 sentence "mini-introduction" to what this study is exploring, including basic background information about the subject, site and study (with citations as needed), and a brief overview of what is included in the exploratory report. You should probably do this last so you know what’s contained in the report.

The "Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present" study explores the relationship between snowshoe hare (Lepus americanus) physical characteristic data (sex, age, and weight) of marked individuals and population trends over the course of 3 years within the Bonanza Creek, Alaska study area. Researchers trapped hares within the Tanana Valley in 5 locations from 1999 to 2002 in an attempt to quantify hare density at a landscape-scale. The study results showed no declines in survivorship despite a decline in density of the study populations.Additionally, body condition of individuals may be positively influencing the populations despite declining densities. *RE-DO AFTER COMPLETING ASSIGNMENT* 

## Data and Anaylses

b) A 3 - 4 sentence section in which you briefly describe the data, including citation & credit as needed, and provide an overview of the main analysis, statistical methods and tools used.

*TO COMPLETE*

## Juvenile Hare Investigation

### Annual Juvenile Hare Trap Counts

```{r}
hare_traps_year <- bonanza_hares_juv_genders %>% 
  mutate(date_new = mdy(date)) %>%
  mutate(year_new = year(date_new)) %>%
  group_by(year_new) %>%
  summarize(sample_size = n())

ggplot(data = hare_traps_year, aes(x = year_new, y = sample_size)) +
  geom_col(fill="brown", color = "black", bins = 15) +
  theme_classic() +
  scale_x_continuous(breaks = 1999:2012) +
  labs(x = "Year",
       y = "Number of Hares",
       title = "Juvenile Hare Trapping Events",
       subtitle = "Bonanza Creek, Alaska: 1999-2012",
       caption = "Data source: Flora, B.K. (2002) & Kielland, K et al. (2017)")
```
```{r}
hare_traps_year %>% 
summarize(mean_sample_size = mean(sample_size, na.rm = TRUE),
          min_sample_size = min(sample_size, na.rm = TRUE),
          max_sample_size = max(sample_size, na.rm = TRUE))
```

Then, in 3 - 4 sentences below your figure, describe major takeaways from your graph about total snowshoe hare trappings at the site. You might consider:

●	What were the minimum and maximum counts of juvenile hare trappings?
●	Mean or median annual number of juvenile hares trapped?
●	General/notable trends?
●	These are absolute counts, but this count is also impacted by effort (e.g. the number of days and number of traps in the study each year). What would you suggest be done moving forward (you are not expected to actually do this) to standardize the juvenile hare population in future analyses?

Juvenile hare trapping success was highest in 1999 (n = `max_sample_size`) with the lowest sample size in 2010 (n = `min_sample_size`), no juveniles trapped in 2002 or 2009 (n = 0), and an annual mean sample size of (  ). *NEED TO FIGURE OUT HOW TO ADD VALUES INTO SENTENCE* A noticeable decline in juvenile trapping rates is visually apparent in the figure above, indicating either a possible decline in population size (or possibly age class, though this cannot be determined without also looking at adult hare trap success), or the researchers simply had less overall success in trapping juvenile hares over the course of the study. *HOW TO STANDARIZE JUV POP TO BE ADDED*

### Juvenile Hare Weights

```{r}
juv_weight_genders <- bonanza_hares_juv_genders %>% 
  select(weight, sex, grid)

ggplot(data = juv_weight_genders, aes(x = sex, y = weight)) +
  geom_col(fill ="brown") +
  facet_wrap(~grid) +
  theme_classic() +
  labs(x = "Hare Gender",
       y = "Weight (g)",
       title = "Juvenile Hare Weights (Per Study Site)",
       subtitle = "Bonanza Creek, Alaska: 1999-2012",
       caption = "Data source: Flora, B.K. (2002) & Kielland, K et al. (2017)")
```


Then, in 2 - 3 sentences below your visualization(s) describe in text the main takeaways that you would want the audience to understand from your figures.

Note: There are multiple ways to visualize these comparisons. We encourage you to think carefully then make decisions about how to visualize these comparisons, including:

●	Can I use faceting to simplify the comparisons into manageable pieces?
●	Am I showing the audience the data, summary statistics, or both?
●	Have I updated graph labels, headers in facets, etc. to make it as straightforward as possible for viewers?
●	Have I simplified and finalized my data visualization(s) to include components that are useful for the audience?

*CHANGE HOW WEIGHTS LOOK ON Y AXIS *            *TO DO*

### Juvenile Weight Comparison

```{r}
juv_weight_m_f_only <- bonanza_hares_juv_genders %>% 
  group_by(sex) %>% 
  summarize(mean_weight_g = mean(weight, na.rm = TRUE),
            sd_weight_g = sd(weight, na.rm = TRUE),
            sample_size = n())

juv_weight_m_f_only %>% 
    kable(digits = 2,
          caption = "Juvenile Hare Weights By Gender (1999-2012)", 
          col.names = c("Gender", "Mean Weight(g)", "Standard Deviation (g)", "Sample Size")) %>%
  kable_styling(full_width = FALSE)
```

```{r include = FALSE}
ggplot(data = bonanza_hares_juv_genders, aes(x = weight)) +
   facet_wrap(~ sex) +
  geom_histogram(fill="brown", color = "black", bins = 10) +
  theme_classic() +
  labs(x = "Hare Gender",
       y = "Weight (g)",
       title = "Juvenile Hare Weights (By Gender)",
       subtitle = "Bonanza Creek, Alaska: 1999-2012",
       caption = "Data source: Flora, B.K. (2002) & Kielland, K et al. (2017)")
```

●	A 2 - 3 sentence comprehensive statement of the means comparison, including at least:
○	The actual difference in means
○	Effect size (Cohen's *d*) (see effsize::cohen.d() example in the Lab 5 key)
○	Outcome of an unpaired two-sample t-test

*TO DO*

### Relationship Between Juvenile Weight & Hind Foot Length

```{r}
ggplot(data = bonanza_hares_juv_genders, aes(x = hindft, y = weight)) +
  geom_point() +
  theme_classic() +
  labs(x = "Hind Foot Length (mm)",
       y = "Weight (g)",
       title = "Juvenile Hare Hind Foot Length and Weight",
       subtitle = "Bonanza Creek, Alaska: 1999-2012",
       caption = "Data source: Flora, B.K. (2002) & Kielland, K et al. (2017)")
```

```{r}
ggplot(data = bonanza_hares_juv_genders, aes(x = hindft, y = weight)) +
  geom_point() +
  geom_smooth(method = "lm") +
  theme_classic() +
    labs(x = "Hind Foot Length (mm)",
       y = "Weight (g)",
       title = "Juvenile Hare Hind Foot Length and Weight",
       subtitle = "Bonanza Creek, Alaska: 1999-2012",
       caption = "Data source: Flora, B.K. (2002) & Kielland, K et al. (2017)")
```

```{r include = FALSE}
# Data Analysis

hare_lm <- lm(hindft ~ weight, data = bonanza_hares_juv_genders)

hare_lm_cor <- cor.test(hindft, weight)

hare_lm_tidy <- tidy(hare_lm)
hare_lm_tidy

hare_lm_glance <- glance(hare_lm)
hare_lm_glance

extract_eq(model = hare_lm, use_coefs = TRUE)
plot(hare_lm)
```

In 2 - 3 sentences below your figure, describe the outcome of your linear regression exploration (e.g. slope interpretation, R2 value, and Pearson's r correlation) and touch briefly on which assumption(s) of linear regression may be a concern, and additional thoughts you have about how well (or not well…) the linear model describes the relationship. What worries you? 

*TO DO* 

## Summary

Include a very short summary describing your main findings from your juvenile hares exploration (bullet points are fine)

*TO DO*

## Citations

Flora, B.K. 2002. Comparison of snowshoe hare populations in Interior Alaska. M.S. Thesis. University of Alaska-Fairbanks.

Kielland, Knut; Chapin, F Stuart; Ruess, Roger. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present, Bonanza Creek LTER - University of Alaska Fairbanks. BNZ:55, http://www.lter.uaf.edu/data/data-detail/id/55. doi:10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14
